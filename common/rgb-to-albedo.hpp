#include <glm/glm.hpp>

inline glm::vec3 srgbToAlbedo(const float wavelength)
{
    using RGB=glm::vec3;

    // The spectra here were prepared in such a way that after being multiplied by
    // the D65 illuminant spectrum and converted to sRGB tristimulus values, each
    // spectrum would yield an RGB triplet of either (1,0,0), (0,1,0), or (0,0,1),
    // depending on which of the spectra is taken. This lets us take an input
    // (linear-)sRGB color, multiply the R,G,B channels by the corresponding spectrum,
    // and add these spectra together to yield the albedo that would have this given
    // color under D65 illuminant.
    static constexpr float wavelengthMin=360, wavelengthMax=830, step=1; // nm
    static constexpr RGB data[]={
     /*360*/ {0.0005858683369379913,0.0035515473829178697,0.03234509480882595},
     /*361*/ {0.0006374363820305045,0.003790569920057804,0.035117155575115286},
     /*362*/ {0.0006928533945697016,0.00404097720287918,0.038089543321876494},
     /*363*/ {0.000752336722637469,0.0043028874269881645,0.04127303580373339},
     /*364*/ {0.000816109349860276,0.004576378652212421,0.04467864619915537},
     /*365*/ {0.0008843993963126175,0.004861485190996758,0.048317594953851045},
     /*366*/ {0.0009574395464063912,0.005158194008455053,0.052201278055099366},
     /*367*/ {0.0010354664011554362,0.00546644116515071,0.056341231640552165},
     /*368*/ {0.0011187197525668277,0.005786108336030693,0.06074909286519751},
     /*369*/ {0.001207441778324791,0.006117019441154491,0.06543655697272861},
     /*370*/ {0.001301876155399407,0.006458937425906732,0.07041533054250111},
     /*371*/ {0.0014227138366903955,0.006910882005893538,0.0768008356208185},
     /*372*/ {0.001553040227455477,0.007384605295571508,0.08367379109246496},
     /*373*/ {0.001693422011809602,0.007880247731748653,0.09106212594217876},
     /*374*/ {0.0018444424870918083,0.008397857695323058,0.09899448982042444},
     /*375*/ {0.0020067003667075833,0.008937383794642728,0.1075001864509571},
     /*376*/ {0.002180808386405621,0.009498667277546755,0.11660909752638718},
     /*377*/ {0.0023673917060601395,0.010081434655050792,0.12635159678682034},
     /*378*/ {0.0025670860999647796,0.01068529062552185,0.1367584540283929},
     /*379*/ {0.0027805359297238086,0.01130971139368293,0.14786072884696802},
     /*380*/ {0.0030083918950525265,0.01195403848380042,0.15968965398738025},
     /*381*/ {0.003207567831771714,0.012447726895289855,0.16995882609875318},
     /*382*/ {0.0034163680596905103,0.01294452377158088,0.1807030608851312},
     /*383*/ {0.0036349640666742647,0.013443070329474217,0.1919293793373889},
     /*384*/ {0.0038635058294782362,0.013941930215366787,0.20364366811312923},
     /*385*/ {0.004102119715954097,0.01443959408728636,0.21585058126932422},
     /*386*/ {0.004350904731292312,0.014934479411712906,0.22855335591402037},
     /*387*/ {0.004609935199789274,0.015424953519186735,0.24175396709781402},
     /*388*/ {0.004879254064696232,0.015909324426779208,0.25545278983109465},
     /*389*/ {0.005158872336307011,0.016385854368497068,0.2696485856912214},
     /*390*/ {0.005448767101129566,0.016852768846334052,0.28433841429831647},
     /*391*/ {0.005514419509111958,0.01660237289462187,0.28730214072890714},
     /*392*/ {0.005587936407103545,0.01637018948271781,0.2906699906318665},
     /*393*/ {0.0056683707439676425,0.016151871395377774,0.2943910914457025},
     /*394*/ {0.005754898004161362,0.015943768409297628,0.2984212882130096},
     /*395*/ {0.005846788518224379,0.01574279592106376,0.30272165195310735},
     /*396*/ {0.005943384706263853,0.015546331275959106,0.3072572581287604},
     /*397*/ {0.006044089911155207,0.0153521514644168,0.31199657552438087},
     /*398*/ {0.0061483506805663475,0.015158360889735179,0.3169105237796552},
     /*399*/ {0.006255648704618901,0.01496335108876295,0.32197203690783566},
     /*400*/ {0.006365493136636417,0.014765765594498796,0.32715565082502396},
     /*401*/ {0.006627490012830324,0.01490191718953211,0.34013942838717764},
     /*402*/ {0.006893217063138847,0.015017014945637704,0.35328443055993647},
     /*403*/ {0.007162250723047604,0.015110452834881756,0.3665692407473313},
     /*404*/ {0.007434138417040643,0.015181740064830541,0.37997113361343055},
     /*405*/ {0.0077083992746475516,0.015230510964350455,0.3934661198632524},
     /*406*/ {0.007984523214181562,0.015256531088635412,0.40702890709799694},
     /*407*/ {0.008261977380708135,0.015259716864712279,0.4206332350036801},
     /*408*/ {0.008540202149707177,0.01524013376356898,0.4342516770105568},
     /*409*/ {0.008818614302311017,0.015198007951932642,0.4478558072612131},
     /*410*/ {0.009096608658095652,0.015133733778057294,0.4614162876475885},
     /*411*/ {0.009442934831967894,0.015159251870584074,0.47841778188612916},
     /*412*/ {0.009791346432514975,0.01516189355131386,0.4954973771102879},
     /*413*/ {0.010141108152652609,0.015142168165239372,0.5126194289272801},
     /*414*/ {0.01049145180649579,0.015100811925303284,0.5297468990516466},
     /*415*/ {0.010841578571821473,0.015038797760535334,0.546841473877768},
     /*416*/ {0.01119066148584662,0.014957344112668865,0.5638636942573736},
     /*417*/ {0.011537848186577293,0.014857922575853364,0.5807730959815111},
     /*418*/ {0.011882263889823955,0.01474226428033696,0.5975283603657953},
     /*419*/ {0.012223014589838412,0.014612364928434493,0.6140874742392627},
     /*420*/ {0.012559190469431382,0.014470488399677774,0.6304078985418738},
     /*421*/ {0.013010704334857081,0.014453402511287582,0.6525067969528467},
     /*422*/ {0.01346368623257154,0.014428663214046933,0.6746666846916071},
     /*423*/ {0.01391716600492116,0.014399221020065564,0.6968425787053918},
     /*424*/ {0.014370136161362653,0.014368417834905075,0.718988012157478},
     /*425*/ {0.014821554854426308,0.014339999872671557,0.7410551873893794},
     /*426*/ {0.01527034571909069,0.014318126102447912,0.7629949699303546},
     /*427*/ {0.015715411395979987,0.014307388111025186,0.7847575640615618},
     /*428*/ {0.01615562756446124,0.014312809427910089,0.8062922113646429},
     /*429*/ {0.01658985013114396,0.014339856050123164,0.8275475445690383},
     /*430*/ {0.017016919473159437,0.014394442242791426,0.8484717912232667},
     /*431*/ {0.01694447477556198,0.014074927687035175,0.8445315217113063},
     /*432*/ {0.01685971192877135,0.013805434753567842,0.8400319151565911},
     /*433*/ {0.016762485865462664,0.013588793961865814,0.8349681425951256},
     /*434*/ {0.016652699527250545,0.013427814604822877,0.8293376540513466},
     /*435*/ {0.016530303567614625,0.013325268754855098,0.8231401433201593},
     /*436*/ {0.01639529258891712,0.013283873123280117,0.8163773405251624},
     /*437*/ {0.01624771488276595,0.013306282531675479,0.8090534774496356},
     /*438*/ {0.016087661332406987,0.013395067427170195,0.8011747157224332},
     /*439*/ {0.015915268170624178,0.013552703407766568,0.7927492654772872},
     /*440*/ {0.015730716051788038,0.01378155871650494,0.783787321015152},
     /*441*/ {0.015622690403853888,0.014164084893934134,0.7787103344789587},
     /*442*/ {0.015498649865455079,0.014624639526342631,0.7729105399113255},
     /*443*/ {0.015358857488684197,0.01516641665708381,0.7664024990535168},
     /*444*/ {0.015203625170258474,0.015792449232903544,0.759202868335716},
     /*445*/ {0.015033312521834555,0.01650559825754178,0.7513303220587456},
     /*446*/ {0.014848299044260794,0.017308512325727745,0.742804140899999},
     /*447*/ {0.01464906328287581,0.01820370947252454,0.7336481503033377},
     /*448*/ {0.014436099133278596,0.019193482337178897,0.7238865213177832},
     /*449*/ {0.014209941625626048,0.02027992165769207,0.7135450413227657},
     /*450*/ {0.013971164829080413,0.021464912575420013,0.7026509935614081},
     /*451*/ {0.013853261346427599,0.022970467411070488,0.6979276152462348},
     /*452*/ {0.013718738020613807,0.024604264686974547,0.6924704454596197},
     /*453*/ {0.013567972797204618,0.026370500297973082,0.6862975294608762},
     /*454*/ {0.013401401072818852,0.028273199790334436,0.6794291404998344},
     /*455*/ {0.01321951420939063,0.030316213708723744,0.6718876704961323},
     /*456*/ {0.013022857824756137,0.03250321518655244,0.663697510089809},
     /*457*/ {0.01281202987717221,0.03483769988558548,0.6548849189671002},
     /*458*/ {0.012587678563020389,0.03732298837125694,0.64547788743083},
     /*459*/ {0.01235050004843207,0.03996223098814937,0.635505990240971},
     /*460*/ {0.01210123605687701,0.04275841527541914,0.6250002337973156},
     /*461*/ {0.011878515764536938,0.04586048542354411,0.6159553042743774},
     /*462*/ {0.011643773564051827,0.049145746285007896,0.606378529744748},
     /*463*/ {0.01139776794057351,0.05261851426847776,0.5962995817000846},
     /*464*/ {0.011141302830939143,0.05628304720682216,0.5857493129886322},
     /*465*/ {0.010875225506738195,0.06014356320928274,0.574759603633436},
     /*466*/ {0.010600406148268378,0.06420415136811425,0.563362232796156},
     /*467*/ {0.010317791369058204,0.06846911214376575,0.551591668557536},
     /*468*/ {0.010028345523750051,0.07294268064808145,0.5394819260021195},
     /*469*/ {0.009733067694127195,0.07762915087551735,0.5270674124125495},
     /*470*/ {0.009432989633828834,0.082532904956073,0.514382769387308},
     /*471*/ {0.009097315806776706,0.08735254267409999,0.4997127674124449},
     /*472*/ {0.00876119126700094,0.09236186082494097,0.4849367241125474},
     /*473*/ {0.008425744358083184,0.097563375560477,0.47009054136195405},
     /*474*/ {0.008092113042922011,0.10295975307694594,0.4552092772741368},
     /*475*/ {0.007761443179077339,0.1085538354633006,0.44032702013800806},
     /*476*/ {0.007434887017996332,0.11434866419716132,0.42547677160609565},
     /*477*/ {0.007113601938325138,0.12034750057540643,0.4106903395885836},
     /*478*/ {0.0067987494201757976,0.126553842332444,0.3959982412165376},
     /*479*/ {0.0064914942634996895,0.1329714356727647,0.38142961614676724},
     /*480*/ {0.0061930040495972736,0.13960428192696617,0.36701215039069024},
     /*481*/ {0.00594633948410817,0.14749571264163908,0.3552748432973415},
     /*482*/ {0.0057073414812786665,0.15572510131694697,0.3435701139450616},
     /*483*/ {0.0054773852270034624,0.16430425516233674,0.3319226078212782},
     /*484*/ {0.005257887872064977,0.17324551456833284,0.3203559764863292},
     /*485*/ {0.005050310379562343,0.1825617379459436,0.30889281363733},
     /*486*/ {0.004856159577571032,0.19226627557987935,0.29755459890145936},
     /*487*/ {0.004676990382779169,0.20237293137068815,0.2863616493944645},
     /*488*/ {0.004514408150725897,0.21289591138850347,0.27533307901922904},
     /*489*/ {0.0043700710971442645,0.22384975823253933,0.2644867654211875},
     /*490*/ {0.004245692722796679,0.23524927028737344,0.25383932446273594},
     /*491*/ {0.004113915605798866,0.24537204973145574,0.24169477360086292},
     /*492*/ {0.0040068397670446464,0.255798812449282,0.2299236043832353},
     /*493*/ {0.003925819817157718,0.2665343975866216,0.21853327150197277},
     /*494*/ {0.0038722197066296754,0.2775830203933043,0.20752962533739627},
     /*495*/ {0.0038474115514575877,0.28894812249967383,0.196916966186528},
     /*496*/ {0.003852766691090914,0.300631661869716,0.18669776140757094},
     /*497*/ {0.003889674022981174,0.3126355549624484,0.17687377183829817},
     /*498*/ {0.003959515205854828,0.3249599353887861,0.1674450179307819},
     /*499*/ {0.004063666960721326,0.3376034847125644,0.158410230996372},
     /*500*/ {0.004203495016891603,0.35056325142366934,0.14976692625555943},
     /*501*/ {0.0043887544570222385,0.36453282619502175,0.14178309987692422},
     /*502*/ {0.004613208586135022,0.3788612710820977,0.13415294852146692},
     /*503*/ {0.0048783717061056196,0.393541598175119,0.126872847462824},
     /*504*/ {0.005185718487188536,0.40856440923703263,0.11993822254940259},
     /*505*/ {0.005536669126527874,0.42391771520386895,0.11334361912384795},
     /*506*/ {0.00593257234200977,0.43958676756727877,0.1070827711725652},
     /*507*/ {0.006374686107279551,0.45555390493551096,0.10114867031203145},
     /*508*/ {0.00686415606054081,0.47179841810282597,0.09553363425217966},
     /*509*/ {0.007401991552149879,0.48829643693663455,0.09022937441112824},
     /*510*/ {0.007989039334243974,0.5050208423127944,0.08522706238944804},
     /*511*/ {0.008637670103078494,0.522650069901431,0.08062674808918463},
     /*512*/ {0.00933853991170004,0.5404920045562913,0.07629792058602955},
     /*513*/ {0.01009205050700986,0.5585104868984632,0.07223153708241742},
     /*514*/ {0.010898315866692052,0.5766658545100573,0.06841821958061796},
     /*515*/ {0.011757123688932985,0.5949149954230086,0.06484831016520949},
     /*516*/ {0.012667895326604204,0.6132114414668566,0.06151192446573737},
     /*517*/ {0.013629644580624255,0.6315055028413424,0.05839900319420167},
     /*518*/ {0.014640935850762442,0.6497444447520974,0.055499361670998844},
     /*519*/ {0.015699842228519712,0.6678727063758282,0.052802737269598415},
     /*520*/ {0.016803904204572603,0.6858321618135251,0.050298834724571855},
     /*521*/ {0.01784913311575179,0.699605378062373,0.04770753028745153},
     /*522*/ {0.018920109493599332,0.7129132326549982,0.045314023525104205},
     /*523*/ {0.02001207731781932,0.7256992651244465,0.04310524112165478},
     /*524*/ {0.021119721260318865,0.7379072534227494,0.04106849181709118},
     /*525*/ {0.022237159414277664,0.7494816576294465,0.03919149259847225},
     /*526*/ {0.023357898857394505,0.7603666469617697,0.03746232134341149},
     /*527*/ {0.024474970241455105,0.7705108122661355,0.03586965402263305},
     /*528*/ {0.025580819610374134,0.7798634088150959,0.03440255709354693},
     /*529*/ {0.026667372894830375,0.7883762039012405,0.03305057893319628},
     /*530*/ {0.02772607053076042,0.7960039201806209,0.03180376091698401},
     /*531*/ {0.028913501518486654,0.8073282628563015,0.030829205842843085},
     /*532*/ {0.030066983297978193,0.8177821711780945,0.029930187714160863},
     /*533*/ {0.031175958000733705,0.827315200111475,0.029099524520435866},
     /*534*/ {0.03222939111251245,0.8358805196927901,0.028330376314974082},
     /*535*/ {0.03321585611667145,0.8434353460720708,0.027616255800291048},
     /*536*/ {0.034123634855739104,0.8499413419951188,0.02695103674928797},
     /*537*/ {0.0349408339570806,0.8553649813865988,0.02632896027841032},
     /*538*/ {0.03565551744388128,0.8596778731209647,0.02574463899604846},
     /*539*/ {0.03625585540147962,0.8628570395790311,0.025193059057561643},
     /*540*/ {0.03673028829344898,0.8648851461763684,0.024669580167424033},
     /*541*/ {0.03696385740650263,0.863325193183421,0.02410221913716678},
     /*542*/ {0.037048808215739304,0.8605971173616549,0.023557431407033348},
     /*543*/ {0.03697684239956075,0.8567111781960308,0.02303154250619855},
     /*544*/ {0.036740824690852054,0.8516835949259639,0.02252126771078262},
     /*545*/ {0.03633499048829866,0.8455364145059566,0.02202369798335488},
     /*546*/ {0.03575508740439114,0.8382957153243425,0.021536243163152616},
     /*547*/ {0.034998794013235586,0.8299962259194603,0.021056741071130477},
     /*548*/ {0.03406571603142139,0.8206761530047036,0.0205833119928606},
     /*549*/ {0.032957657130451706,0.8103784810609674,0.020114383097261677},
     /*550*/ {0.03167880945937668,0.7991505973763615,0.019648668876304197},
     /*551*/ {0.03034352309880034,0.7898445167791588,0.019253419871134037},
     /*552*/ {0.02884311977550983,0.779644100301518,0.018856828965011094},
     /*553*/ {0.02718829443583989,0.7685982914579481,0.018458326846479585},
     /*554*/ {0.025392918323873977,0.7567593639091076,0.018057543654501098},
     /*555*/ {0.023474186698440154,0.7441824766623685,0.017654291315860614},
     /*556*/ {0.021452738542432803,0.7309252129151624,0.017248545746638127},
     /*557*/ {0.019352744493486534,0.7170471082327388,0.01684042907156651},
     /*558*/ {0.0172019594429864,0.7026091737381849,0.01643019201038955},
     /*559*/ {0.015031736544473963,0.6876734198893248,0.01601819657386947},
     /*560*/ {0.012876999742151257,0.6723023862291422,0.015604899203978317},
     /*561*/ {0.010772060198054831,0.6563081401818008,0.015185037677980847},
     /*562*/ {0.008764341136877187,0.6400139072049311,0.014765280413245539},
     /*563*/ {0.0068987201225223695,0.6234815303806708,0.014346274739970705},
     /*564*/ {0.005223003668732355,0.6067715706077367,0.013928700738980563},
     /*565*/ {0.0037876600991727134,0.5899429368054437,0.013513258182000897},
     /*566*/ {0.002645505665518651,0.5730525474798976,0.013100654507913399},
     /*567*/ {0.0018513454844421692,0.556155025947863,0.01269159387908306},
     /*568*/ {0.001461571609788973,0.5393024309497805,0.012286767347219162},
     /*569*/ {0.0015337213084283018,0.5225440238217733,0.01188684414387632},
     /*570*/ {0.0021259993429396857,0.5059260728471521,0.011492464096845869},
     /*571*/ {0.0032860867511947493,0.48790566979418587,0.01106825181835919},
     /*572*/ {0.005070921098655141,0.47021199454517,0.010653182291456781},
     /*573*/ {0.007530785802134753,0.4528791793561835,0.010247706455198832},
     /*574*/ {0.010713723991364875,0.43593751246893575,0.009852220124009159},
     /*575*/ {0.01466499224852061,0.41941347477881047,0.009467062440086218},
     /*576*/ {0.019426525205891245,0.4033298075057252,0.009092515249865273},
     /*577*/ {0.025036418173408466,0.3877056079650266,0.008728803317913893},
     /*578*/ {0.03152843489100162,0.3725564503826555,0.008376095288715593},
     /*579*/ {0.038931547303782885,0.35789452860449156,0.008034505305352182},
     /*580*/ {0.04726951394197825,0.34372881751116496,0.007704095194053875},
     /*581*/ {0.05695052273046786,0.3323412541428073,0.007435800423212874},
     /*582*/ {0.06774518742368216,0.32131033873453896,0.007175149276655956},
     /*583*/ {0.07968334593635462,0.310643736421231,0.006922216806454707},
     /*584*/ {0.09278915382055827,0.30034682793041145,0.006677039749311455},
     /*585*/ {0.10708073054089853,0.2904228454312431,0.00643961903249005},
     /*586*/ {0.1225698581678598,0.2808730153349756,0.0062099224693200105},
     /*587*/ {0.13926173679260442,0.2716967060119825,0.005987887588878832},
     /*588*/ {0.15715480022139725,0.26289157851413286,0.00577342454819245},
     /*589*/ {0.17624059470020298,0.25445373853113185,0.005566419079448049},
     /*590*/ {0.1965037225640829,0.2463778879615491,0.005366735429180208},
     /*591*/ {0.21585519552606888,0.23639417260159915,0.005125149675543931},
     /*592*/ {0.23591166079241654,0.22690458410508207,0.004894220472951519},
     /*593*/ {0.25660816505476514,0.21789022637515298,0.004673555054800119},
     /*594*/ {0.277875015536376,0.20933179306360206,0.004462758706162791},
     /*595*/ {0.29963832672167917,0.20120972839876455,0.0042614375008408695},
     /*596*/ {0.32182060394528006,0.1935043740427629,0.004069200741223421},
     /*597*/ {0.3443413564094951,0.18619610202141335,0.0038856631031528952},
     /*598*/ {0.3671177319192698,0.1792654339265163,0.0037104464922226373},
     /*599*/ {0.3900651654726142,0.1726931467249437,0.003543181621525362},
     /*600*/ {0.41309803382333593,0.16646036562248237,0.0033835093238457807},
     /*601*/ {0.4369679027761845,0.16085698050770403,0.00323728695244232},
     /*602*/ {0.4608403212704382,0.15553543332776823,0.0030974196174398307},
     /*603*/ {0.48462949619313395,0.15047994903589482,0.002963621192566393},
     /*604*/ {0.5082504591076934,0.1456752284268616,0.002835616276539689},
     /*605*/ {0.5316196583823647,0.1411064914903873,0.002713140559428553},
     /*606*/ {0.5546553988385977,0.13675948172618885,0.002595940456141097},
     /*607*/ {0.5772787311947131,0.13262058624170067,0.002483774966094612},
     /*608*/ {0.599413591797544,0.1286767601670944,0.0023764137911651715},
     /*609*/ {0.6209873623589183,0.12491557204883667,0.002273637819168455},
     /*610*/ {0.6419312700700004,0.12132521082036116,0.0021752388890043627},
     /*611*/ {0.663286779538275,0.11809140661946958,0.002084495411649374},
     /*612*/ {0.6839577459975854,0.1149965227626803,0.00199745697417524},
     /*613*/ {0.7038852082966183,0.11203123539735253,0.0019139635657933187},
     /*614*/ {0.7230147774466352,0.10918676349246084,0.0018338636198913885},
     /*615*/ {0.7412968205219084,0.10645485892883048,0.001757013612094418},
     /*616*/ {0.7586865956009775,0.10382779379802723,0.001683277640595205},
     /*617*/ {0.7751443389285062,0.10129834533204078,0.0016125269967966086},
     /*618*/ {0.7906353060444642,0.09885977885922063,0.0015446397332781127},
     /*619*/ {0.8051297691332538,0.09650582915493412,0.0014795002351096647},
     /*620*/ {0.8186029732849894,0.09423068052840854,0.00141699879959668},
     /*621*/ {0.8334253678587948,0.09229364959288176,0.0013609344690144267},
     /*622*/ {0.8472816092259235,0.09041540778063027,0.0013070119287280093},
     /*623*/ {0.8601533167556331,0.08859176920057334,0.0012551527475777443},
     /*624*/ {0.8720263293866921,0.08681887006143799,0.0012052821579929148},
     /*625*/ {0.8828905636778687,0.08509315058728964,0.001157328766606581},
     /*626*/ {0.8927396401399372,0.08341131729534433,0.0011112240222529194},
     /*627*/ {0.9015713245069367,0.08177038444205902,0.0010669027667992452},
     /*628*/ {0.9093867141208414,0.08016759633927187,0.0010243021822546512},
     /*629*/ {0.9161902319318508,0.07860043029283163,0.000983361859409963},
     /*630*/ {0.9219894089474381,0.0770665798593014,0.0009440236053966888},
     /*631*/ {0.9214331771327602,0.07512680322294724,0.0009009887449136182},
     /*632*/ {0.9198571499974176,0.07323378306051095,0.0008598704946995407},
     /*633*/ {0.9172936296427467,0.07138526454385247,0.0008205907624792936},
     /*634*/ {0.9137766844887547,0.06957918683563295,0.0007830743099190046},
     /*635*/ {0.9093418730914764,0.06781366582220816,0.0007472485993489056},
     /*636*/ {0.9040259815462324,0.06608697813486614,0.0007130436579854875},
     /*637*/ {0.8978667756934048,0.06439754643118718,0.0006803919579588949},
     /*638*/ {0.8909027690195295,0.0627439258977668,0.0006492283104946368},
     /*639*/ {0.8831730068431427,0.06112479192658382,0.0006194897726592454},
     /*640*/ {0.8747168670951446,0.05953892890986744,0.0005911155651537536},
     /*641*/ {0.8698149134137102,0.05826932915885076,0.0005668106499483374},
     /*642*/ {0.8642068039906786,0.05701838537062059,0.0005435250462597462},
     /*643*/ {0.8579220838365029,0.055785433189022605,0.0005212187095957986},
     /*644*/ {0.8509905979709005,0.05456987005532914,0.0004998527270372858},
     /*645*/ {0.8434423749430652,0.05337115001536667,0.00047938929973829954},
     /*646*/ {0.8353075213962262,0.05218877909694597,0.00045979172884423516},
     /*647*/ {0.826616127180868,0.051022311205626385,0.0004410244040797002},
     /*648*/ {0.8173981804384746,0.04987134448679192,0.00042305279432812513},
     /*649*/ {0.8076834920156701,0.04873551810271852,0.0004058434395939158},
     /*650*/ {0.7975016285257317,0.047614509374684436,0.00038936394380569613},
     /*651*/ {0.7830871137392414,0.04628374615081396,0.0003717813632330311},
     /*652*/ {0.7683717235044156,0.04497789684323086,0.00035501358734109443},
     /*653*/ {0.7533893920771864,0.04369652832732783,0.0003390220269968589},
     /*654*/ {0.738173067830971,0.04243924085270363,0.0003237696806016394},
     /*655*/ {0.72275469100482,0.04120566567204712,0.00030922109982075023},
     /*656*/ {0.7071651768076915,0.03999546283736752,0.00029534235451329126},
     /*657*/ {0.6914344031550533,0.038808319131579706,0.00028210099675964387},
     /*658*/ {0.675591202382572,0.03764394610810949,0.0002694660239304981},
     /*659*/ {0.6596633563512753,0.036502078215633636,0.000257407840781897},
     /*660*/ {0.6436775944277726,0.035382470989265176,0.0002458982205961016},
     /*661*/ {0.626195904091454,0.03420494758414582,0.0002343624593104177},
     /*662*/ {0.6087886453167981,0.03305466575659034,0.0002233743654401726},
     /*663*/ {0.5914786608874814,0.03193124186465443,0.000212905897756076},
     /*664*/ {0.5742875525926122,0.030834310135023888,0.00020293047175551468},
     /*665*/ {0.5572357025549258,0.02976352083939445,0.00019342290061009342},
     /*666*/ {0.5403422952950832,0.028718538520346462,0.0001843593365975179},
     /*667*/ {0.523625340394068,0.027699040267245463,0.0001757172131470563},
     /*668*/ {0.5071016956529207,0.026704714044139682,0.0001674751876284234},
     /*669*/ {0.49078709068030996,0.025735257072723703,0.00015961308501200207},
     /*670*/ {0.47469615086400135,0.024790374274224206,0.00015211184252420822},
     /*671*/ {0.46223662019948913,0.024046348853822338,0.00014602572070179204},
     /*672*/ {0.44982807590022855,0.02331472571708099,0.00014017438555978564},
     /*673*/ {0.43748489453296646,0.02259558438865539,0.00013454738800336243},
     /*674*/ {0.42522081960625296,0.021889005307247824,0.00012913483809700332},
     /*675*/ {0.413048959669145,0.02119506863470565,0.00012392737997135507},
     /*676*/ {0.4009817871645232,0.020513853099721403,0.00011891616686414133},
     /*677*/ {0.3890311380851135,0.019845434882283595,0.00011409283639210604},
     /*678*/ {0.37720821247903014,0.019189886544691632,0.00010944948614453087},
     /*679*/ {0.3655235758486348,0.018547276014526493,0.00010497864968198815},
     /*680*/ {0.3539871614820318,0.01791766562447872,0.0001006732730168014},
     /*681*/ {0.34463017315156635,0.01740321355321747,0.00009709634297772949},
     /*682*/ {0.33535078994190043,0.016896947433651183,0.00009363698239267073},
     /*683*/ {0.3261572212662837,0.016398978792572357,0.00009029070745735},
     /*684*/ {0.31705725220091857,0.01590941439392075,0.00008705328860207137},
     /*685*/ {0.30805824306160345,0.01542835555866779,0.00008392073559765395},
     /*686*/ {0.299167047974487,0.014955893444720238,0.000080889260975266},
     /*687*/ {0.2903902643711155,0.0144921208950706,0.00007795533347725938},
     /*688*/ {0.2817339837498889,0.014037119322091845,0.00007511559595815269},
     /*689*/ {0.2732038791946486,0.013590962485233607,0.00007236687564644193},
     /*690*/ {0.26480520899826,0.013153716072752836,0.00006970617168002195},
     /*691*/ {0.2527078570809127,0.012535209469158468,0.0000661271319628706},
     /*692*/ {0.24101404732645842,0.011939244686761066,0.00006271031499449814},
     /*693*/ {0.22971924829782442,0.011365348325619766,0.000059448958632277696},
     /*694*/ {0.21881841142325378,0.010813041483800566,0.00005633661734964066},
     /*695*/ {0.2083060085664009,0.010281840250031307,0.00005336714131813264},
     /*696*/ {0.19817606907574922,0.009771256245548757,0.000050534657035832175},
     /*697*/ {0.1884222162328923,0.009280797208443103,0.00004783354942043519},
     /*698*/ {0.17903770302187214,0.00880996761391304,0.00004525844528547615},
     /*699*/ {0.17001544714506414,0.008358269323998966,0.000042804198118811455},
     /*700*/ {0.16134806521496514,0.007925202260557287,0.000040465874083582965},
     /*701*/ {0.15284652849642769,0.007501363493227267,0.00003819341638953495},
     /*702*/ {0.14470455214855435,0.007096158598153128,0.000036032953581796455},
     /*703*/ {0.1369126470329219,0.006709014007552297,0.000033979695272095296},
     /*704*/ {0.129461210013782,0.006339360452475281,0.000032029044488501134},
     /*705*/ {0.12234055285653245,0.005986633593926308,0.00003017658724163796},
     /*706*/ {0.11554089824653456,0.005650273099695144,0.000028418075206520124},
     /*707*/ {0.10905250440229668,0.0053297280622035485,0.000026749441208114275},
     /*708*/ {0.10286558746534985,0.0050244525690641825,0.000025166765910661647},
     /*709*/ {0.09697038058097174,0.004733908009433027,0.00002366627927605436},
     /*710*/ {0.09135715598764167,0.0044575636113922375,0.00002224435382126969},
     /*711*/ {0.08783899041567966,0.0042837897656882945,0.000021340331103955843},
     /*712*/ {0.08442921942982545,0.004115573915078016,0.00002046873742318473},
     /*713*/ {0.08112666486148266,0.003952833280286924,0.000019628718609145956},
     /*714*/ {0.07793003555317646,0.0037954815674349743,0.000018819437803228895},
     /*715*/ {0.07483793613375819,0.0036434292596122784,0.000018040074531102942},
     /*716*/ {0.07184887570279418,0.003496583911796409,0.000017289823928019483},
     /*717*/ {0.06896127640704047,0.003354850447950332,0.00001656789610484471},
     /*718*/ {0.06617348189414353,0.0032181314592520777,0.000015873515643942443},
     /*719*/ {0.06348376563109115,0.003086327502527594,0.000015205921214695451},
     /*720*/ {0.060890339077486894,0.002959337398087399,0.000014564365299182316},
     /*721*/ {0.05642479029094224,0.0027415089012267396,0.0000134783538600686},
     /*722*/ {0.05226326020646834,0.0025386119848200706,0.00001246855818920436},
     /*723*/ {0.04838670370556834,0.002349698604865198,0.000011529919795178144},
     /*724*/ {0.04477717199554879,0.002173876821770883,0.000010657705706168542},
     /*725*/ {0.04141775277011666,0.0020103075632885103,9.847486782150046e-6},
     /*726*/ {0.03829251387405299,0.0018582015943272346,9.095117685722997e-6},
     /*727*/ {0.03538645020107254,0.0017168166765111534,8.396718357599273e-6},
     /*728*/ {0.03268543358221123,0.0015854549021410804,7.748656859214501e-6},
     /*729*/ {0.030176165446998967,0.001463460188818168,7.147533459504505e-6},
     /*730*/ {0.027846132061675754,0.0013502159223972004,6.590165855801504e-6},
     /*731*/ {0.025795925887621085,0.0012505901462450408,6.100146881743472e-6},
     /*732*/ {0.023883041237840345,0.0011576649554138133,5.643570650818883e-6},
     /*733*/ {0.022099378299323808,0.0010710415864205963,5.218385298240315e-6},
     /*734*/ {0.020437231535100076,0.0009903411349315527,4.822648896867681e-6},
     /*735*/ {0.018889276495908453,0.0009152038334875754,4.454524479058867e-6},
     /*736*/ {0.017448556651923554,0.0008452883387498005,4.112275254978809e-6},
     /*737*/ {0.016108470279050238,0.0007802710291173117,3.7942600171128383e-6},
     /*738*/ {0.014862757432053456,0.0007198453135335039,3.4989287218435923e-6},
     /*739*/ {0.013705487034530605,0.0006637209522555091,3.2248182399275792e-6},
     /*740*/ {0.012631044113485953,0.0006116233903138333,2.9705482685605215e-6},
     /*741*/ {0.011896826568555,0.000576012795130225,2.7965721606172196e-6},
     /*742*/ {0.011200993525382008,0.0005422704966432696,2.6318393220042873e-6},
     /*743*/ {0.010541898758893508,0.0005103156044618662,2.4759362087202435e-6},
     /*744*/ {0.009917940976983132,0.000480069527922322,2.328462624600349e-6},
     /*745*/ {0.00932756444610757,0.0004514559946163645,2.1890316045726603e-6},
     /*746*/ {0.008769256877384305,0.0004244009373477654,2.0572686778943935e-6},
     /*747*/ {0.008241557669549546,0.0003988328832737455,1.932813582404566e-6},
     /*748*/ {0.007743049877207424,0.00037468255621088826,1.8153181787317997e-6},
     /*749*/ {0.00727236303868795,0.000351883005358251,1.704446931246609e-6},
     /*750*/ {0.006828173060986331,0.00033036959229902483,1.5998767144254307e-6},
     /*751*/ {0.006468041079743157,0.0003129266338100513,1.515079122793747e-6},
     /*752*/ {0.006127796174378249,0.00029644874367677553,1.4350054554190806e-6},
     /*753*/ {0.0058065549184262,0.00028089282711011296,1.3594408327026102e-6},
     /*754*/ {0.005503469689429417,0.0002662175590839348,1.2881796040006333e-6},
     /*755*/ {0.005217728922767775,0.0002523833928821063,1.221025323346755e-6},
     /*756*/ {0.004948555557447113,0.0002393524815271595,1.1577903096294586e-6},
     /*757*/ {0.004695213065017032,0.00022708896630264214,1.098296987950694e-6},
     /*758*/ {0.004457000225803876,0.00021555872125701833,1.0423766039235686e-6},
     /*759*/ {0.004233253742011144,0.00020472947703873294,9.8986977772399e-7},
     /*760*/ {0.004023349139426744,0.00019457086217292385,9.406266626379777e-7},
     /*761*/ {0.003530073446930064,0.00017070987952791053,8.251690526156863e-7},
     /*762*/ {0.0031008286108607525,0.00014994717699478625,7.247199391117322e-7},
     /*763*/ {0.002726521073866588,0.0001318425974988971,6.371446011184054e-7},
     /*764*/ {0.0023995127710740435,0.00011602645506989243,5.606504588322732e-7},
     /*765*/ {0.002113354529013419,0.00010218662401901597,4.937243433883366e-7},
     /*766*/ {0.0018625751851846911,0.00009005832684718004,4.350828846278203e-7},
     /*767*/ {0.0016425133305607068,0.00007941598648557824,3.8363293260699746e-7},
     /*768*/ {0.0014491819819358726,0.00007006667337910614,3.3843973035820656e-7},
     /*769*/ {0.0012791589311660831,0.00006184479611504631,2.987011300728584e-7},
     /*770*/ {0.001129497288339987,0.00005460777003188448,2.6372656170865774e-7},
     /*771*/ {0.0010333919878364106,0.00004996034406149691,2.4126390223837905e-7},
     /*772*/ {0.0009448983050485911,0.00004568114099735893,2.2058351098162374e-7},
     /*773*/ {0.000863466021086801,0.00004174352354678831,2.0155611252465013e-7},
     /*774*/ {0.0007885799986570232,0.000038122555473973274,1.8406073409124616e-7},
     /*775*/ {0.0007197583468353706,0.00003479491224617309,1.6798426299039537e-7},
     /*776*/ {0.0006565506483859377,0.00003173879477697754,1.532210203106685e-7},
     /*777*/ {0.0005985362503719358,0.000028933846294864532,1.3967235085667963e-7},
     /*778*/ {0.0005453226184854093,0.00002636107235042157,1.2724622926551797e-7},
     /*779*/ {0.0004965437552227973,0.000024002763961929987,1.158568821881039e-7},
     /*780*/ {0.00045185868176143384,0.000021842423886521263,1.05424426371897e-7},
     /*781*/ {0.00040813771565905273,0.00001972875526774864,9.521842117620642e-8},
     /*782*/ {0.00036841754838297234,0.000017808538995969083,8.594714316761411e-8},
     /*783*/ {0.00033235587859535706,0.00001606521835390406,7.753050044865635e-8},
     /*784*/ {0.0002996373148529759,0.000014483538994067237,6.989471477647486e-8},
     /*785*/ {0.000269971488364553,0.000013049457489700536,6.297187627625183e-8},
     /*786*/ {0.00024309127697744987,0.000011750055291633367,5.6699524760842056e-8},
     /*787*/ {0.00021875113574605317,0.00001057345786277191,5.1020256490806325e-8},
     /*788*/ {0.00019672552945209287,9.508758763215494e-6,4.588135522279567e-8},
     /*789*/ {0.00017680746248505835,8.545948461210648e-6,4.123444641160416e-8},
     /*790*/ {0.00015880710154673162,7.675847648190676e-6,3.7035173451802476e-8},
     /*791*/ {0.0001438400773031535,6.952375998357029e-6,3.35436284912768e-8},
     /*792*/ {0.0001302097688747863,6.2935253849062945e-6,3.0364078725489945e-8},
     /*793*/ {0.00011780433884262342,5.693888182361096e-6,2.747039718730907e-8},
     /*794*/ {0.00010652056406711608,5.148473439030852e-6,2.4838472733834493e-8},
     /*795*/ {0.0000962632425370633,4.652678164638431e-6,2.2446070759338733e-8},
     /*796*/ {0.00008694460630611777,4.202258917806319e-6,2.0272695453899503e-8},
     /*797*/ {0.00007848388582022711,3.7933107156148733e-6,1.829948747267098e-8},
     /*798*/ {0.00007080671990335107,3.4222384877147514e-6,1.6509085713855016e-8},
     /*799*/ {0.00006384472590485021,3.0857362753152e-6,1.488552652749811e-8},
     /*800*/ {0.00005753506446924611,2.7807661735632313e-6,1.3414141744539996e-8},
     /*801*/ {0.00005205316740221348,2.5158063933711066e-6,1.2135817050290356e-8},
     /*802*/ {0.00004707182634238312,2.2750418254755017e-6,1.0974251701225535e-8},
     /*803*/ {0.00004254770200798709,2.0563773683946983e-6,9.919331365385437e-9},
     /*804*/ {0.000038440962758984756,1.857887519072887e-6,8.961761037861356e-9},
     /*805*/ {0.0000347150249647538,1.6778038146945826e-6,8.093004290216197e-9},
     /*806*/ {0.000031336298873525205,1.514502541723691e-6,7.305223832140411e-9},
     /*807*/ {0.000028273998061353515,1.366495518938347e-6,6.591236920953356e-9},
     /*808*/ {0.00002549988953968032,1.232418013456839e-6,5.944456959611919e-9},
     /*809*/ {0.000022988110147746542,1.1110198612411208e-6,5.3588505672331224e-9},
     /*810*/ {0.000020714982849778718,1.001156583759234e-6,4.828894644491226e-9},
     /*811*/ {0.000018197789939523657,8.794983147722919e-7,4.2420603687826e-9},
     /*812*/ {0.000015978228159540935,7.722252037488837e-7,3.7246212500699095e-9},
     /*813*/ {0.00001402211476190922,6.776850618946528e-7,3.2686058973700403e-9},
     /*814*/ {0.000012299073610631949,5.944096996157795e-7,2.8669308527870755e-9},
     /*815*/ {0.000010782124795531972,5.210950880727203e-7,2.5133048259506393e-9},
     /*816*/ {9.4473170365121e-6,4.565835895397554e-7,2.202142920064184e-9},
     /*817*/ {8.27339856117895e-6,3.9984804780950524e-7,1.92848984053461e-9},
     /*818*/ {7.241522561653159e-6,3.499775503354972e-7,1.6879511761400306e-9},
     /*819*/ {6.334983718645526e-6,3.0616469229621924e-7,1.47663193215664e-9},
     /*820*/ {5.538982626450079e-6,2.6769418947901866e-7,1.2910815757235553e-9},
     /*821*/ {4.862298170764151e-6,2.3499028218179178e-7,1.133345579571488e-9},
     /*822*/ {4.265721384746832e-6,2.061580071082983e-7,9.942840923982535e-10},
     /*823*/ {3.7400946458517725e-6,1.8075476314130285e-7,8.717620877651195e-10},
     /*824*/ {3.2772668272578466e-6,1.5838659623126608e-7,7.638792332590201e-10},
     /*825*/ {2.8699875434105546e-6,1.3870308767558484e-7,6.689452244788275e-10},
     /*826*/ {2.511811088475177e-6,1.2139271096380267e-7,5.854573809447684e-10},
     /*827*/ {2.1970135470128825e-6,1.0617882532099267e-7,5.120813144780747e-10},
     /*828*/ {1.9205127630989804e-6,9.281580748091357e-8,4.4763226573368417e-10},
     /*829*/ {1.677800288207446e-6,8.108576245000543e-8,3.910592343785418e-10},
     /*830*/ {1.4648792926768174e-6,7.079552254399593e-8,3.414305006206315e-10},
    };
    constexpr auto numPoints=sizeof data/sizeof*data;
    static_assert(numPoints==1+(wavelengthMax-wavelengthMin)/step, "Mismatch between number of points in data and expected number of points");
    if(wavelength<wavelengthMin || wavelength>wavelengthMax)
        return RGB{0};
    const auto fractionalIndex=(wavelength-wavelengthMin)/step;
    assert(fractionalIndex>=0);
    assert(fractionalIndex<numPoints);
    const unsigned smallerIdx=std::floor(fractionalIndex);
    const unsigned largerIdx =std::ceil (fractionalIndex);
    assert(smallerIdx<numPoints);
    assert(largerIdx<numPoints);
    assert(smallerIdx<=largerIdx);
    if(smallerIdx==largerIdx) return data[smallerIdx];
    const auto alpha=fractionalIndex-int(fractionalIndex);
    return data[smallerIdx]*(1-alpha)+data[largerIdx]*alpha;
}
